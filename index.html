<!DOCTYPE html><html lang="fr"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Contacts ENEO ‚Äî v12_dark_compact_v3.2h2 2025-09-11 18:58</title>
<meta name="theme-color" content="#5b6169">
<style>
:root{ --bg:#6b7178; --card:#8c9299; --text:#0b1220; --muted:#212733; --border:#4e5560; --accent:#2563eb;
  --zebra1:#9aa0a7; --zebra2:#8c9299; --good:#8ee59e; --bad:#f28b82; --warn:#fbc02d; }
*{box-sizing:border-box} html,body{margin:0;padding:0}
body{background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial}
.container{max-width:980px;margin:0 auto;padding:8px}
h1{display:flex;gap:8px;align-items:center;margin:0 0 6px;font-size:17px}
.ver{font-size:9px;color:var(--muted);border:1px solid var(--border);border-radius:999px;padding:1px 6px;background:#fff}
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:8px;margin:8px 0}
button{background:var(--accent);color:#fff;border:none;border-radius:10px;padding:6px 8px;font-weight:600;cursor:pointer;font-size:16px;line-height:1;touch-action:manipulation}
button.secondary{background:#fff;color:#000;border:1px solid var(--border)}
.controls{display:flex;gap:6px;flex-wrap:wrap;align-items:center}
.controls .icon{width:32px;height:32px;display:inline-flex;align-items:center;justify-content:center;border-radius:10px}
input[type="text"],input[type="email"],input[type="tel"],input[type="number"],input[type="date"],input[type="file"]{background:#fff;border:1px solid var(--border);border-radius:8px;padding:6px 8px;font-size:14px}
.table-wrap{overflow-x:auto;-webkit-overflow-scrolling:touch}
table{width:100%;border-collapse:separate;border-spacing:0 4px;table-layout:auto}
thead th{font-size:11px;color:var(--muted);border-bottom:1px dashed var(--border);text-transform:uppercase;position:sticky;top:0;background:var(--card);z-index:1}
tbody tr{background:var(--zebra2);border:1px solid var(--border)}
tbody tr:nth-child(odd){background:var(--zebra1)}
tbody td{padding:4px 6px;vertical-align:middle;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
tbody tr td:first-child{border-top-left-radius:10px;border-bottom-left-radius:10px}
tbody tr td:last-child{border-top-right-radius:10px;border-bottom-right-radius:10px}
tr.state-green{background:var(--good)!important} tr.state-red{background:var(--bad)!important} tr.state-yellow{background:var(--warn)!important}
.amount input{width:6ch;text-align:right}
.col-pres{width:46px} .col-amt{width:64px}
.col-name{width:auto;max-width:22ch} .col-pre{width:auto;max-width:16ch}
.col-gsm{width:110px} .col-mail{width:auto;min-width:28ch}
.pres input[type="checkbox"]{width:20px;height:20px}
.actions{white-space:nowrap;width:84px; overflow:visible !important; position:sticky; right:0; background:var(--card);}
.actions button{padding:4px 6px;font-size:16px}
.actions{display:flex;gap:6px;justify-content:center;align-items:center}
.small{color:#101318;background:rgba(255,255,255,.35);border:1px solid var(--border);border-radius:10px;padding:6px;margin-top:6px;font-size:12px;display:flex;flex-wrap:wrap;gap:12px}
.toast{position:fixed;bottom:18px;left:50%;transform:translateX(-50%);background:#111827;color:#e5e7eb;padding:8px 12px;border-radius:10px;border:1px solid #374151;display:none}
.debug{font:12px ui-monospace,monospace;background:#111827;color:#f3f4f6;border:1px solid #374151;border-radius:10px;padding:8px;white-space:pre-wrap}
.hidden{display:none!important}
@media (max-width: 430px){ .col-name{max-width:20ch} .col-pre{max-width:14ch} .col-mail{min-width:30ch} }
@media print{body{background:#fff!important;color:#000!important}.card{box-shadow:none!important;border:none!important;background:#fff!important}
table,thead,tbody,tr,td,th{page-break-inside:avoid!important}tr{page-break-after:auto}}
</style></head><body>
<div class="container">
  <h1>Contacts ENEO ‚Äî <span class="ver">v12_dark_compact_v3.2h2 2025-09-11 18:58</span></h1>

  <div class="card">
    <div class="controls">
      <label for="sessionDate" style="font-size:12px">Date</label><input id="sessionDate" type="date" style="height:32px">
      <button id="exportPDF" class="secondary icon" title="Imprimer/PDF">üñ®Ô∏è</button>
      <button id="resetFields" class="secondary icon" title="R√©initialiser Pr√©sence/‚Ç¨">üßπ</button>
      <button id="resetRoster" class="secondary icon" title="R√©initialiser la liste (CSV int√©gr√©)">‚ôªÔ∏è</button>
      <button id="saveRoster" class="secondary icon" title="Sauver la liste">üíæ</button>
      <button id="copyTable" class="secondary icon" title="Copier Pr√©s/‚Ç¨/Nom/Pr√©nom">üìã</button>
      <button id="toggleGsmMail" class="secondary icon" title="Montrer/Cacher GSM+Mail">üëÅÔ∏è</button>
    </div>
  </div>

  <div class="card">
    <div class="controls">
      <button id="toggleAddForm" class="icon" title="Afficher/Masquer le formulaire">‚ûï</button>
      <input id="importCsv" type="file" accept=".csv" title="Choisir un CSV">
      <button id="importCsvReplace" class="secondary icon" title="Importer CSV (Remplacer)">‚¨áÔ∏è</button>
    </div>
    <div id="addForm" style="display:none;margin-top:6px;gap:6px" class="controls">
      <input id="addNom" placeholder="Nom"><input id="addPrenom" placeholder="Pr√©nom">
      <input id="addGsm" placeholder="GSM (047...)"><input id="addMail" placeholder="Mail">
      <button id="addMember" class="icon" title="Ajouter">‚úÖ</button>
    </div>
  </div>

  <div class="card table-wrap">
    <table id="tbl"><thead>
      <tr><th class="col-pres">Pr√©s.</th><th class="col-amt">‚Ç¨</th><th class="col-name">Nom</th><th class="col-pre">Pr√©nom</th><th class="col-gsm">GSM</th><th class="col-mail">Mail</th><th>Actions</th></tr>
    </thead><tbody id="tbody"></tbody></table>

    <div class="small">
      <div>Pr√©sents: <span id="countPresence">0</span></div>
      <div>Pr√©sents gratuits: <span id="countFree">0</span></div>
      <div>Pr√©sents 0‚Ç¨: <span id="countZero">0</span></div>
      <div>Pr√©sents payants: <span id="countPaid">0</span></div>
      <div>Total ‚Ç¨: <span id="sumPaid">0,0</span></div>
      <div>Inscrits: <span id="inscritsCounter">0</span></div>
    </div>
  </div>

  <div class="card" id="diagCard">
    <div id="diag" class="debug">Initialisation‚Ä¶</div>
  </div>
</div>
<div class="toast" id="toast">OK</div>

<script id="seed" type="application/json">[{"nom": "ALLACKER", "prenom": "Paul", "gsm": "477621626", "mail": "paul.allacker@skynet.be"}, {"nom": "BOSSCHAERT", "prenom": "Fran√ßoise", "gsm": "474717828", "mail": "francoise.bosschaert@gmail.com"}, {"nom": "CHARLIER", "prenom": "Pierre", "gsm": "475677680", "mail": "charlier.pierre@skynet.be"}, {"nom": "CHIMKOVITCH", "prenom": "Sophie", "gsm": "474979997", "mail": "sophie.chimkovitch@gmail.om"}, {"nom": "DALLEUR", "prenom": "Jean-Paul", "gsm": "474877837", "mail": "dalleurj@gmail.com"}, {"nom": "DECONINCK", "prenom": "Jean-Pierre", "gsm": "476728383", "mail": "sra@lesanemones.be"}, {"nom": "DEGUENT", "prenom": "Marianne", "gsm": "474811346", "mail": "mdeguent7@gmail.com"}, {"nom": "DENIS", "prenom": "Pierrette", "gsm": "472720227", "mail": "Pierrette_denis@outlook.be"}, {"nom": "DEPIREUX", "prenom": "Dominique", "gsm": "479949630", "mail": "gekerado@gmail.com"}, {"nom": "DIEU", "prenom": "Bernard", "gsm": "476294840", "mail": "planetedit0@gmail.com"}, {"nom": "DOLVELDE", "prenom": "Dick", "gsm": "478780555", "mail": "dick.dolvelde@gmail.com"}, {"nom": "DONNAY", "prenom": "Jacques", "gsm": "476634435", "mail": "jack.donnay30@gmai.com"}, {"nom": "DUBOIS", "prenom": "Claude", "gsm": "477712083", "mail": "dubois.claude@hotmail.com"}, {"nom": "GILLET", "prenom": "Christiane", "gsm": "474693200", "mail": "christiane.gillet@hotmail.com"}, {"nom": "HEYTERS", "prenom": "Eric", "gsm": "475826923", "mail": "eric.heyters@gmail.com"}, {"nom": "LEGLISE", "prenom": "Stephan", "gsm": "476340062", "mail": "unpierreux@yahoo.fr"}, {"nom": "LEVEAU", "prenom": "Jos√©", "gsm": "479321442", "mail": "jcleveau@yahoo.fr"}, {"nom": "LEVELING", "prenom": "Josette", "gsm": "475386560", "mail": "josette.paulus@gmail.com"}, {"nom": "MAGERUS", "prenom": "Michel", "gsm": "476892128", "mail": "michelmagerus@gmail.com"}, {"nom": "MALDAGUE", "prenom": "Olivier", "gsm": "478371701", "mail": "olivier.maldague@gmail.com"}, {"nom": "PAPENS", "prenom": "Dominique", "gsm": "475993125", "mail": "dompapens@yahoo.fr"}, {"nom": "PAULUS", "prenom": "Christian", "gsm": "475284580", "mail": "chpaulus@gmail.com"}, {"nom": "PERROTIN", "prenom": "Herv√©", "gsm": "472212131", "mail": "hymperrotin@gmail.com"}, {"nom": "PUTMANS", "prenom": "Yves", "gsm": "478669111", "mail": "yves.putmans@yahoo.fr"}, {"nom": "RION", "prenom": "Marc-Antoine", "gsm": "475388934", "mail": "marcantoinerion1965@gmail.com"}, {"nom": "SCHILDERMANS", "prenom": "Alain", "gsm": "475606443", "mail": "alain.schildermans@gmail.com"}, {"nom": "VAN PELT", "prenom": "V√©ronique", "gsm": "477456193", "mail": "veronique.vanpelt@icloud.com"}, {"nom": "VANCAPPELLEN", "prenom": "Arlette", "gsm": "477359066", "mail": "arlettevancap@hotmail.com"}, {"nom": "VANDEN BRUGGE", "prenom": "Andr√©e", "gsm": "475381914", "mail": "audrey.vdb.bruens@gmail.com"}, {"nom": "VANDENBROUCKE", "prenom": "Jacques", "gsm": "477261193", "mail": "javanwa41@gmail.com"}, {"nom": "VIGNERON", "prenom": "Jean-Marie", "gsm": "474921000", "mail": "jemavig@live.be"}, {"nom": "WERY", "prenom": "Jean-Luc", "gsm": "478293294", "mail": "weryjl@hotmail.fr"}, {"nom": "WINDAL", "prenom": "Beno√Æt", "gsm": "475941124", "mail": "michele.et.benoit.windal@gmail.com"}]</script>

<script>
(function(){
  const rosterKey='contacts-eneo:roster-compact-v3.2h2';
  const $=s=>document.querySelector(s), $$=s=>Array.from(document.querySelectorAll(s));
  const toast=(m)=>{const t=$('#toast');t.textContent=m||'OK';t.style.display='block';setTimeout(()=>t.style.display='none',1200)};
  const diag=(msg)=>{ const d=$('#diag'); d.textContent = (d.textContent? d.textContent+"\n":"")+msg; };
  const showErr=(msg)=>{ diag("ERREUR JS ‚Üí "+msg); };
  window.onerror = function(msg, src, line, col){ showErr(msg + " @ " + line + ":" + col); };

  function getSeed(){ try{ return JSON.parse(document.getElementById('seed').textContent || "[]"); } catch(e){ return []; } }
  const CSV_ROSTER = getSeed();

  let colsHidden = true;
  function setColsVisibility(hide){
    colsHidden = hide;
    document.querySelectorAll('th.col-gsm,th.col-mail,td.col-gsm,td.col-mail').forEach(td=>td.classList.toggle('hidden',hide));
  }

  function normGSM(s){
    if(!s) return '';
    var t=String(s).trim().replace(/[^0-9+]/g,'');
    if(t.indexOf('+324')===0) t='0'+t.slice(3);
    if(t.indexOf('0')!==0) t='0'+t.replace(/^0+/,'');
    if(t.indexOf('04')===0 && t.indexOf('047')!==0) t='047'+t.slice(3);
    t=t.replace(/\D/g,''); if(t.length>10) t=t.slice(0,10);
    return t;
  }

  function loadRosterRaw(){ try{ var r=JSON.parse(localStorage.getItem(rosterKey)||'[]'); return Array.isArray(r)?r:[]; } catch(e){ return []; } }
  function loadRoster(){
    var r = loadRosterRaw();
    if(!r || r.length===0){ r = CSV_ROSTER.slice(); try{ localStorage.setItem(rosterKey, JSON.stringify(r)); }catch(e){} diag("Liste restaur√©e √† partir du CSV int√©gr√©"); }
    return r.map(m=>({ nom:(m.nom||''), prenom:(m.prenom||''), gsm:normGSM(m.gsm||''), mail:(m.mail||'') }));
  }
  function saveRoster(r){ r.forEach(m=>{ m.gsm=normGSM(m.gsm||''); }); try{ localStorage.setItem(rosterKey, JSON.stringify(r)); }catch(e){} updateCounts(); }

  function makeRow(m){
    var tr=document.createElement('tr');
    tr.innerHTML='<td class="pres"><input type="checkbox"></td>' +
                 '<td class="amount"><input type="number" step="0.5" min="0" placeholder="0,0"></td>' +
                 '<td class="name col-name"></td><td class="pre col-pre"></td>' +
                 '<td class="gsm col-gsm"></td><td class="mail col-mail"></td>' +
                 '<td class="actions"><button class="secondary editRow" title="Modifier">‚úèÔ∏è</button><button class="secondary deleteRow" title="Supprimer">üóëÔ∏è</button></td>';
    tr.querySelector('.name').textContent=(m.nom||'').trim();
    tr.querySelector('.pre').textContent=(m.prenom||'').trim();
    tr.querySelector('.gsm').textContent=normGSM((m.gsm||'').trim());
    tr.querySelector('.mail').textContent=(m.mail||'').trim();
    tr.querySelector('.mail').setAttribute('title', (m.mail||''));
    return tr;
  }

  function rebuild(){
    var tb=$('#tbody'); tb.innerHTML='';
    var r=loadRoster(); r.forEach(m=>tb.appendChild(makeRow(m)));
    $('#inscritsCounter').textContent=r.length;
    diag('JS OK ‚Äî lignes: '+r.length);
    updateCounts();
    setColsVisibility(true);
  }

  function applyRowStates(){
    $$('#tbl tbody tr').forEach(function(tr){
      tr.classList.remove('state-green','state-red','state-yellow');
      var present=tr.querySelector('.pres input').checked;
      var txt=(tr.querySelector('.amount input').value||'').trim();
      var amt=txt===''? null:(parseFloat(txt.replace(',','.'))||0);
      if(present){
        if(amt===null) tr.classList.add('state-yellow');
        else if(amt>0) tr.classList.add('state-green');
        else tr.classList.add('state-red');
      }
    });
  }

  function updateCounts(){
    var present=0,free=0,zero=0,paidCount=0,paidSum=0;
    $$('#tbl tbody tr').forEach(function(tr){
      var cb=tr.querySelector('.pres input');
      var txt=(tr.querySelector('.amount input').value||'').trim();
      var amt=txt===''? null:(parseFloat(txt.replace(',','.'))||0);
      if(cb.checked){
        present++;
        if(amt===null) free++;
        else if(amt===0) zero++;
        else if(amt>0){ paidCount++; paidSum+=amt; }
      }
      tr.querySelector('.gsm').textContent=normGSM(tr.querySelector('.gsm').textContent);
    });
    $('#countPresence').textContent=String(present);
    $('#countFree').textContent=String(free);
    $('#countZero').textContent=String(zero);
    $('#countPaid').textContent=String(paidCount);
    $('#sumPaid').textContent=paidSum.toFixed(1).replace('.',',');
    applyRowStates();
  }

  document.addEventListener('input',function(e){
    if(e.target && e.target.matches('.amount input')){
      var tr=e.target.closest('tr');
      tr.querySelector('.pres input').checked = (e.target.value||'').trim()!=='';
      updateCounts();
    }
  });
  document.addEventListener('change',function(e){
    if(e.target && e.target.matches('.pres input')){
      var tr=e.target.closest('tr');
      if(!e.target.checked) tr.querySelector('.amount input').value='';
      updateCounts();
    }
  });

  document.addEventListener('click',function(e){
    if(e.target && e.target.matches('.editRow')){
      var tr=e.target.closest('tr');
      var n=tr.querySelector('.name').textContent.trim(),
          p=tr.querySelector('.pre').textContent.trim(),
          g=tr.querySelector('.gsm').textContent.trim(),
          m=tr.querySelector('.mail').textContent.trim();
      tr.dataset.orig=[n,p,g,m].join('|');
      tr.querySelector('.name').innerHTML='<input class="e-name" value="'+n.replace(/"/g,'&quot;')+'">';
      tr.querySelector('.pre').innerHTML='<input class="e-pre" value="'+p.replace(/"/g,'&quot;')+'">';
      tr.querySelector('.gsm').innerHTML='<input class="e-gsm" value="'+g.replace(/"/g,'&quot;')+'">';
      tr.querySelector('.mail').innerHTML='<input class="e-mail" value="'+m.replace(/"/g,'&quot;')+'">';
      e.target.textContent='üíæ'; e.target.classList.add('saveRow'); e.target.classList.remove('editRow');
    } else if(e.target && e.target.matches('.saveRow')){
      var tr=e.target.closest('tr');
      var n=tr.querySelector('.e-name').value.trim(),
          p=tr.querySelector('.e-pre').value.trim(),
          g=tr.querySelector('.e-gsm').value.trim(),
          m=tr.querySelector('.e-mail').value.trim();
      var r=loadRoster();
      var parts=(tr.dataset.orig||'|||').split('|');
      var idx=r.findIndex(function(x){ return (x.nom||'')===parts[0] && (x.prenom||'')===parts[1] && (x.gsm||'')===parts[2] && (x.mail||'')===parts[3]; });
      if(idx>=0) r[idx]={nom:n,prenom:p,gsm:g,mail:m}; else r.push({nom:n,prenom:p,gsm:g,mail:m});
      saveRoster(r); rebuild(); toast('Membre modifi√© ‚úÖ');
    } else if(e.target && e.target.matches('.deleteRow')){
      var tr=e.target.closest('tr');
      var parts=[tr.querySelector('.name').textContent.trim(),tr.querySelector('.pre').textContent.trim(),tr.querySelector('.gsm').textContent.trim(),tr.querySelector('.mail').textContent.trim()];
      var r=loadRoster().filter(function(x){ return !(((x.nom||'')===parts[0])&&((x.prenom||'')===parts[1])&&((x.gsm||'')===parts[2])&&((x.mail||'')===parts[3])); });
      saveRoster(r); rebuild(); toast('Membre supprim√© üóëÔ∏è');
    } else if(e.target && e.target.id==='toggleGsmMail'){
      setColsVisibility(!colsHidden);
    } else if(e.target && e.target.id==='toggleAddForm'){
      var f=document.getElementById('addForm'); f.style.display=(f.style.display==='none'?'flex':'none'); if(f.style.display==='') f.style.display='flex';
    } else if(e.target && e.target.id==='addMember'){
      var n=document.getElementById('addNom').value.trim(),
          p=document.getElementById('addPrenom').value.trim(),
          g=document.getElementById('addGsm').value.trim(),
          m=document.getElementById('addMail').value.trim();
      if(!n && !p && !g){ toast('Nom ou GSM requis'); return; }
      var r=loadRoster(); r.push({nom:n,prenom:p,gsm:g,mail:m}); saveRoster(r); rebuild();
      document.getElementById('addNom').value=document.getElementById('addPrenom').value=document.getElementById('addGsm').value=document.getElementById('addMail').value='';
      toast('Membre ajout√© ‚úÖ');
    } else if(e.target && e.target.id==='copyTable'){
      var lines=['Pr√©sence;‚Ç¨;Nom;Pr√©nom'];
      $$('#tbl tbody tr').forEach(function(tr){
        var pres = tr.querySelector('.pres input').checked ? '1' : '0';
        var amtTxt = (tr.querySelector('.amount input').value||'').trim();
        if(amtTxt){ var n = parseFloat(amtTxt.replace(',','.')); amtTxt = isNaN(n) ? '' : n.toFixed(1).replace('.',','); }
        var nom = tr.querySelector('.name').textContent.trim();
        var pre = tr.querySelector('.pre').textContent.trim();
        lines.push([pres, amtTxt, nom, pre].join(';'));
      });
      var text = lines.join('\r\n');
      function fallbackCopy(){ var ta=document.createElement('textarea'); ta.value=text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove(); toast('Copi√© ‚úÖ'); }
      if(navigator.clipboard && navigator.clipboard.writeText){ navigator.clipboard.writeText(text).then(function(){ toast('Copi√© ‚úÖ'); }).catch(fallbackCopy); } else { fallbackCopy(); }
    } else if(e.target && e.target.id==='importCsvReplace'){
      (async function(){
        var f=document.getElementById('importCsv').files[0]; if(!f){ toast('Choisis un CSV'); return; }
        var txt=await f.text(); var lines=txt.trim().split(/\r?\n/); var sep=lines[0].indexOf(';')>=0?';':',';
        var cols=lines[0].split(sep).map(function(s){return s.trim().toLowerCase();});
        function idx(n){ return cols.findIndex(function(c){ return new RegExp(n).test(c); }); }
        var iNom=idx('^nom$'), iPre=idx('^pr|^pre'), iGsm=idx('gsm|t|mobile'), iMail=idx('mail|email');
        var r=[];
        for(var i=1;i<lines.length;i++){ var c=lines[i].split(sep); r.push({nom:(c[iNom]||'').trim(),prenom:(c[iPre]||'').trim(),gsm:String(c[iGsm]||'').trim(),mail:(c[iMail]||'').trim()}); }
        saveRoster(r); rebuild(); toast('Liste remplac√©e ‚úÖ');
      })();
    } else if(e.target && e.target.id==='resetRoster'){
      try{localStorage.removeItem(rosterKey);}catch(e){}
      rebuild(); toast('Liste r√©initialis√©e ‚ôªÔ∏è');
    } else if(e.target && e.target.id==='saveRoster'){
      saveRoster(loadRoster()); toast('Liste sauvegard√©e üíæ');
    } else if(e.target && e.target.id==='exportPDF'){
      window.print();
    }
  });

  document.getElementById('resetFields').addEventListener('click', function(){ 
    $$('#tbl tbody tr').forEach(function(tr){ tr.querySelector('.pres input').checked=false; tr.querySelector('.amount input').value=''; });
    updateCounts(); toast('Pr√©sence/‚Ç¨ remis √† z√©ro üßπ');
  });

  document.getElementById('sessionDate').value=(new Date()).toISOString().slice(0,10);
  diag("Chargement des donn√©es‚Ä¶");
  rebuild();
  setColsVisibility(true);
})();
</script>
</body></html>
