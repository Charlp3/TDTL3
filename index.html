<!DOCTYPE html><html lang="fr"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Contacts ENEO ‚Äî v12_dark_full_zebra_v3.3 2025-09-11 16:07</title>
<meta name="theme-color" content="#8e949b">
<style>
:root{
  --bg:#8d939a; --card:#b7bcc2; --text:#0b1220; --muted:#2b3340; --border:#6f7680; --accent:#2563eb;
  --zebra1:#c5c9cf; --zebra2:#b7bcc2;
  --good:#8ee59e; --bad:#f28b82; --warn:#fbc02d;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial}
.container{max-width:1100px;margin:0 auto;padding:12px}
h1{display:flex;gap:8px;align-items:center;margin:0 0 8px;font-size:19px}
.ver{font-size:9px;color:var(--muted);border:1px solid var(--border);border-radius:999px;padding:1px 6px;background:#fff}
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:10px;margin:8px 0}
.small{color:var(--muted);font-size:12px}
button{background:var(--accent);color:#fff;border:none;border-radius:10px;padding:6px 10px;font-weight:600;cursor:pointer;font-size:14px;line-height:1}
button.secondary{background:#fff;color:var(--text);border:1px solid var(--border)}
input[type="text"],input[type="email"],input[type="tel"],input[type="number"],input[type="date"],input[type="file"]{background:#fff;border:1px solid var(--border);border-radius:8px;padding:5px 8px;font-size:14px}
table{width:100%;border-collapse:separate;border-spacing:0 6px}
thead th{font-size:11px;color:var(--muted);border-bottom:1px dashed var(--border);text-transform:uppercase}
tbody tr{background:var(--zebra2);border:1px solid var(--border)}
tbody tr:nth-child(odd){background:var(--zebra1)}
tbody td{padding:6px 6px;vertical-align:middle}
tbody tr td:first-child{border-top-left-radius:10px;border-bottom-left-radius:10px}
tbody tr td:last-child{border-top-right-radius:10px;border-bottom-right-radius:10px}
tr.state-green{background:var(--good)!important}
tr.state-red{background:var(--bad)!important}
tr.state-yellow{background:var(--warn)!important}
.amount input{width:6ch;text-align:right}
.col-pres{width:52px}.col-amt{width:66px}
.pres input[type="checkbox"]{width:20px;height:20px}
.actions{white-space:nowrap}
.actions button{font-size:13px;padding:5px 8px}
.toast{position:fixed;bottom:18px;left:50%;transform:translateX(-50%);background:#111827;color:#e5e7eb;padding:8px 12px;border-radius:10px;border:1px solid #374151;display:none}
.debug{font:12px ui-monospace,monospace;background:#111827;color:#f3f4f6;border:1px solid #374151;border-radius:10px;padding:8px;white-space:pre-wrap}
.hidden{display:none!important}
@media print{body{background:#fff!important;color:#000!important}.card{box-shadow:none!important;border:none!important;background:#fff!important}
table,thead,tbody,tr,td,th{page-break-inside:avoid!important}tr{page-break-after:auto}}
</style></head><body>
<div class="container">
  <h1>Contacts ENEO ‚Äî <span class="ver">v3.3</span></h1>

  <div class="card">
    <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
      <label for="sessionDate">Date :</label><input id="sessionDate" type="date">
      <button id="exportPDF" class="secondary">üñ®Ô∏è PDF</button>
      <button id="resetFields" class="secondary">üßπ R√©initialiser cases (Pr√©s/‚Ç¨)</button>
      <button id="resetRoster" class="secondary">‚ôªÔ∏è R√©initialiser liste</button>
      <button id="saveRoster" class="secondary">üíæ Sauver</button>
      <button id="copyTable" class="secondary">üìã Copier (Pr√©s/‚Ç¨/Nom/Pr√©nom)</button>
      <button id="toggleGsmMail" class="secondary">üëÅÔ∏è Cacher/Montrer GSM+Mail</button>
    </div>
  </div>

  <div class="card">
    <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
      <button id="toggleAddForm">‚ûï Ajouter</button>
      <input id="importCsv" type="file" accept=".csv">
      <button id="importCsvReplace" class="secondary">Importer CSV (Remplacer)</button>
      <button id="exportRosterJson" class="secondary">Exporter JSON</button>
      <input id="importJson" type="file" accept=".json">
      <button id="importRosterJson" class="secondary">Importer JSON</button>
    </div>
    <div id="addForm" style="display:none;margin-top:8px;gap:8px">
      <input id="addNom" placeholder="Nom"><input id="addPrenom" placeholder="Pr√©nom">
      <input id="addGsm" placeholder="GSM (047...)"><input id="addMail" placeholder="Mail">
      <button id="addMember">‚úÖ Ajouter</button>
    </div>
  </div>

  <div class="card">
    <table id="tbl"><thead>
      <tr><th class="col-pres">Pr√©s.</th><th class="col-amt">‚Ç¨</th><th>Nom</th><th>Pr√©nom</th><th class="col-gsm">GSM</th><th class="col-mail">Mail</th><th>Actions</th></tr>
    </thead><tbody id="tbody"></tbody></table>
    <div class="small" style="margin-top:6px;display:flex;flex-wrap:wrap;gap:14px">
      <div>Pr√©sents: <span id="countPresence">0</span></div>
      <div>Pr√©sents gratuits: <span id="countFree">0</span></div>
      <div>Pr√©sents 0‚Ç¨: <span id="countZero">0</span></div>
      <div>Pr√©sents payants: <span id="countPaid">0</span></div>
      <div>Total ‚Ç¨ pay√©s: <span id="sumPaid">0,0</span></div>
      <div>Inscrits: <span id="inscritsCounter">0</span></div>
    </div>
  </div>

  <div class="card" id="diagCard">
    <div id="diag" class="debug">Initialisation‚Ä¶</div>
  </div>
</div>
<div class="toast" id="toast">OK</div>

<script id="seed" type="application/json">[{"nom": "ALLACKER", "prenom": "Paul", "gsm": "477621626", "mail": "paul.allacker@skynet.be"}, {"nom": "BOSSCHAERT", "prenom": "Fran√ßoise", "gsm": "474717828", "mail": "francoise.bosschaert@gmail.com"}, {"nom": "CHARLIER", "prenom": "Pierre", "gsm": "475677680", "mail": "charlier.pierre@skynet.be"}, {"nom": "CHIMKOVITCH", "prenom": "Sophie", "gsm": "474979997", "mail": "sophie.chimkovitch@gmail.om"}, {"nom": "DALLEUR", "prenom": "Jean-Paul", "gsm": "474877837", "mail": "dalleurj@gmail.com"}, {"nom": "DECONINCK", "prenom": "Jean-Pierre", "gsm": "476728383", "mail": "sra@lesanemones.be"}, {"nom": "DEGUENT", "prenom": "Marianne", "gsm": "474811346", "mail": "mdeguent7@gmail.com"}, {"nom": "DENIS", "prenom": "Pierrette", "gsm": "472720227", "mail": "Pierrette_denis@outlook.be"}, {"nom": "DEPIREUX", "prenom": "Dominique", "gsm": "479949630", "mail": "gekerado@gmail.com"}, {"nom": "DIEU", "prenom": "Bernard", "gsm": "476294840", "mail": "planetedit0@gmail.com"}, {"nom": "DOLVELDE", "prenom": "Dick", "gsm": "478780555", "mail": "dick.dolvelde@gmail.com"}, {"nom": "DONNAY", "prenom": "Jacques", "gsm": "476634435", "mail": "jack.donnay30@gmai.com"}, {"nom": "DUBOIS", "prenom": "Claude", "gsm": "477712083", "mail": "dubois.claude@hotmail.com"}, {"nom": "GILLET", "prenom": "Christiane", "gsm": "474693200", "mail": "christiane.gillet@hotmail.com"}, {"nom": "HEYTERS", "prenom": "Eric", "gsm": "475826923", "mail": "eric.heyters@gmail.com"}, {"nom": "LEGLISE", "prenom": "Stephan", "gsm": "476340062", "mail": "unpierreux@yahoo.fr"}, {"nom": "LEVEAU", "prenom": "Jos√©", "gsm": "479321442", "mail": "jcleveau@yahoo.fr"}, {"nom": "LEVELING", "prenom": "Josette", "gsm": "475386560", "mail": "josette.paulus@gmail.com"}, {"nom": "MAGERUS", "prenom": "Michel", "gsm": "476892128", "mail": "michelmagerus@gmail.com"}, {"nom": "MALDAGUE", "prenom": "Olivier", "gsm": "478371701", "mail": "olivier.maldague@gmail.com"}, {"nom": "PAPENS", "prenom": "Dominique", "gsm": "475993125", "mail": "dompapens@yahoo.fr"}, {"nom": "PAULUS", "prenom": "Christian", "gsm": "475284580", "mail": "chpaulus@gmail.com"}, {"nom": "PERROTIN", "prenom": "Herv√©", "gsm": "472212131", "mail": "hymperrotin@gmail.com"}, {"nom": "PUTMANS", "prenom": "Yves", "gsm": "478669111", "mail": "yves.putmans@yahoo.fr"}, {"nom": "RION", "prenom": "Marc-Antoine", "gsm": "475388934", "mail": "marcantoinerion1965@gmail.com"}, {"nom": "SCHILDERMANS", "prenom": "Alain", "gsm": "475606443", "mail": "alain.schildermans@gmail.com"}, {"nom": "VAN PELT", "prenom": "V√©ronique", "gsm": "477456193", "mail": "veronique.vanpelt@icloud.com"}, {"nom": "VANCAPPELLEN", "prenom": "Arlette", "gsm": "477359066", "mail": "arlettevancap@hotmail.com"}, {"nom": "VANDEN BRUGGE", "prenom": "Andr√©e", "gsm": "475381914", "mail": "audrey.vdb.bruens@gmail.com"}, {"nom": "VANDENBROUCKE", "prenom": "Jacques", "gsm": "477261193", "mail": "javanwa41@gmail.com"}, {"nom": "VIGNERON", "prenom": "Jean-Marie", "gsm": "474921000", "mail": "jemavig@live.be"}, {"nom": "WERY", "prenom": "Jean-Luc", "gsm": "478293294", "mail": "weryjl@hotmail.fr"}, {"nom": "WINDAL", "prenom": "Beno√Æt", "gsm": "475941124", "mail": "michele.et.benoit.windal@gmail.com"}]</script>

<script>
(function(){
  function getSeed(){ try{ return JSON.parse(document.getElementById('seed').textContent || "[]"); } catch(e){ return []; } }
  const CSV_ROSTER = getSeed();
  const rosterKey='contacts-eneo:roster-zebra-v3.3';
  const $=s=>document.querySelector(s), $$=s=>Array.from(document.querySelectorAll(s));
  const toast=(m)=>{const t=$('#toast');t.textContent=m||'OK';t.style.display='block';setTimeout(()=>t.style.display='none',1200)};
  const diag=(msg)=>{ const d=$('#diag'); d.textContent = (d.textContent? d.textContent+"\n":"")+msg; };
  const showErr=(msg)=>{ diag("ERREUR JS ‚Üí "+msg); };
  window.onerror = function(msg, src, line, col){ showErr(msg + " @ " + line + ":" + col); };

  try{
    diag("JS d√©marr√© ‚úÖ");

    function loadRosterRaw(){ try{ var r=JSON.parse(localStorage.getItem(rosterKey)||'[]'); return r && r.constructor===Array ? r: []; } catch(e){ return []; } }
    function loadRoster(){ var r=loadRosterRaw(); if(!r||r.length===0){ r=CSV_ROSTER.slice(); try{localStorage.setItem(rosterKey, JSON.stringify(r));}catch(e){} diag("Liste restaur√©e √† partir du CSV int√©gr√©"); } return r; }
    function saveRoster(r){ try{ localStorage.setItem(rosterKey, JSON.stringify(r)); }catch(e){} updateCounts(); }

    function makeRow(m){
      var tr=document.createElement('tr');
      tr.innerHTML='<td class="pres"><input type="checkbox"></td><td class="amount"><input type="number" step="0.5" min="0" placeholder="0,0"></td>'+
                   '<td class="name"></td><td class="pre"></td><td class="gsm col-gsm"></td><td class="mail col-mail"></td>'+
                   '<td class="actions"><button class="secondary editRow">‚úèÔ∏è</button> <button class="secondary deleteRow">üóëÔ∏è</button></td>';
      tr.querySelector('.name').textContent=(m.nom||'').trim();
      tr.querySelector('.pre').textContent=(m.prenom||'').trim();
      tr.querySelector('.gsm').textContent=(m.gsm||'').trim();
      tr.querySelector('.mail').textContent=(m.mail||'').trim();
      return tr;
    }
    function rebuild(){ var tb=$('#tbody'); tb.innerHTML=''; var r=loadRoster(); r.forEach(function(m){ tb.appendChild(makeRow(m)); }); $('#inscritsCounter').textContent=r.length; diag('JS OK ‚Äî lignes: '+r.length); updateCounts(); }

    function applyRowStates(){
      $$('#tbl tbody tr').forEach(function(tr){
        tr.classList.remove('state-green','state-red','state-yellow');
        var present=tr.querySelector('.pres input').checked;
        var txt=(tr.querySelector('.amount input').value||'').trim();
        var amt=txt===''? null:(parseFloat(txt.replace(',','.'))||0);
        if(present){ if(amt===null) tr.classList.add('state-yellow'); else if(amt>0) tr.classList.add('state-green'); else tr.classList.add('state-red'); }
      });
    }
    function updateCounts(){
      var present=0,free=0,zero=0,paidCount=0,paidSum=0;
      $$('#tbl tbody tr').forEach(function(tr){
        var cb=tr.querySelector('.pres input');
        var txt=(tr.querySelector('.amount input').value||'').trim();
        var amt=txt===''? null:(parseFloat(txt.replace(',','.'))||0);
        if(cb.checked){ present++; if(amt===null) free++; else if(amt===0) zero++; else if(amt>0){ paidCount++; paidSum+=amt; } }
      });
      $('#countPresence').textContent=String(present); $('#countFree').textContent=String(free);
      $('#countZero').textContent=String(zero); $('#countPaid').textContent=String(paidCount);
      $('#sumPaid').textContent=paidSum.toFixed(1).replace('.',','); applyRowStates();
    }

    document.getElementById('resetFields').addEventListener('click',function(){ $$('#tbl tbody tr').forEach(function(tr){ tr.querySelector('.pres input').checked=false; tr.querySelector('.amount input').value=''; }); updateCounts(); toast('Cases pr√©sence/‚Ç¨ r√©initialis√©es üßπ'); });
    let colsHidden=false; function setColsVisibility(hide){ colsHidden=hide; document.querySelectorAll('th.col-gsm,th.col-mail,td.col-gsm,td.col-mail').forEach(td=>td.classList.toggle('hidden',hide)); }
    document.getElementById('toggleGsmMail').addEventListener('click',()=>setColsVisibility(!colsHidden));

    document.addEventListener('input',function(e){ if(e.target && e.target.matches('.amount input')){ var tr=e.target.closest('tr'); tr.querySelector('.pres input').checked=(e.target.value||'').trim()!==''; } if(e.target && e.target.matches('.pres input,.amount input')) updateCounts(); });
    document.addEventListener('change',function(e){ if(e.target && e.target.matches('.pres input')){ var tr=e.target.closest('tr'); if(!e.target.checked) tr.querySelector('.amount input').value=''; updateCounts(); } });

    document.getElementById('resetRoster').addEventListener('click',function(){ try{localStorage.removeItem(rosterKey);}catch(e){} rebuild(); toast('Liste r√©initialis√©e ‚ôªÔ∏è'); });
    document.getElementById('saveRoster').addEventListener('click',function(){ saveRoster(loadRoster()); toast('Liste sauvegard√©e üíæ'); });
    document.getElementById('exportPDF').addEventListener('click',()=>window.print());

    document.getElementById('sessionDate').value=(new Date()).toISOString().slice(0,10);
    diag("Chargement des donn√©es‚Ä¶"); rebuild();
    setColsVisibility(false);
  }catch(e){ showErr(e && e.message ? e.message:String(e)); }
})();</script>
</body></html>
